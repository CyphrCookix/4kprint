<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Test Runner - 4K Print</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: white;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        
        .test-button:hover {
            background: #45a049;
        }
        
        .test-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        
        .console-output {
            background: #1e1e1e;
            color: #ffffff;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 500px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .instructions {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üß™ Translation Test Runner</h1>
        <p>Comprehensive testing suite for 4K Print website translations</p>
    </div>

    <div class="instructions">
        <h3>üìã Instructions:</h3>
        <ol>
            <li>Make sure you have the main website (index.html) open in another tab</li>
            <li>Ensure i18n.js is loaded and working</li>
            <li>Click "Run All Tests" to execute the complete test suite</li>
            <li>Review the console output for detailed results</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>üöÄ Test Execution</h2>
        <div id="testStatus" class="status" style="display: none;"></div>
        
        <button id="runAllTests" class="test-button">Run All Tests</button>
        <button id="runValidation" class="test-button">Translation Validation Only</button>
        <button id="runLanguageSwitching" class="test-button">Language Switching Only</button>
        <button id="runConsoleErrors" class="test-button">Console Errors Only</button>
        <button id="clearConsole" class="test-button" style="background: #ff6b6b;">Clear Console</button>
        
        <div id="consoleOutput" class="console-output"></div>
    </div>

    <div class="test-section">
        <h2>üìä Test Results Summary</h2>
        <div id="testSummary">
            <p>No tests run yet. Click "Run All Tests" to begin.</p>
        </div>
    </div>

    <!-- Load required scripts -->
    <script src="i18n.js"></script>
    <script src="test-translation-validation.js"></script>
    <script src="test-language-switching.js"></script>
    <script src="test-console-errors.js"></script>
    <script src="test-translation-complete.js"></script>

    <script>
        // Console output capture
        const consoleOutput = document.getElementById('consoleOutput');
        const testStatus = document.getElementById('testStatus');
        const testSummary = document.getElementById('testSummary');
        
        // Store original console methods
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn
        };
        
        // Override console to capture output
        function captureConsole() {
            console.log = (...args) => {
                originalConsole.log.apply(console, args);
                appendToConsole(args.join(' '), 'log');
            };
            
            console.error = (...args) => {
                originalConsole.error.apply(console, args);
                appendToConsole(args.join(' '), 'error');
            };
            
            console.warn = (...args) => {
                originalConsole.warn.apply(console, args);
                appendToConsole(args.join(' '), 'warn');
            };
        }
        
        function appendToConsole(message, type) {
            const timestamp = new Date().toLocaleTimeString();
            const colorMap = {
                log: '#ffffff',
                error: '#ff6b6b',
                warn: '#ffd93d'
            };
            
            consoleOutput.innerHTML += `<span style="color: ${colorMap[type] || '#ffffff'}">[${timestamp}] ${message}</span>\n`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        function setStatus(message, type) {
            testStatus.textContent = message;
            testStatus.className = `status ${type}`;
            testStatus.style.display = 'block';
        }
        
        function setLoading(button, isLoading) {
            if (isLoading) {
                button.innerHTML = '<div class="loading"></div>Running...';
                button.disabled = true;
            } else {
                button.innerHTML = button.getAttribute('data-original-text');
                button.disabled = false;
            }
        }
        
        // Initialize console capture
        captureConsole();
        
        // Store original button texts
        document.querySelectorAll('.test-button').forEach(button => {
            button.setAttribute('data-original-text', button.textContent);
        });
        
        // Event listeners
        document.getElementById('runAllTests').addEventListener('click', async () => {
            const button = document.getElementById('runAllTests');
            setLoading(button, true);
            setStatus('Running complete test suite...', 'warning');
            
            try {
                if (typeof CompleteTranslationTester === 'undefined') {
                    throw new Error('CompleteTranslationTester not loaded');
                }
                
                const results = await CompleteTranslationTester.quickTest();
                
                // Update summary
                if (results && results.summary) {
                    const { totalPassed, totalFailed, totalTests } = results.summary;
                    const successRate = totalTests > 0 ? ((totalPassed / totalTests) * 100).toFixed(1) : 0;
                    
                    testSummary.innerHTML = `
                        <h3>üìä Test Results:</h3>
                        <p><strong>Total Tests:</strong> ${totalTests}</p>
                        <p><strong>Passed:</strong> <span style="color: green;">${totalPassed}</span></p>
                        <p><strong>Failed:</strong> <span style="color: red;">${totalFailed}</span></p>
                        <p><strong>Success Rate:</strong> ${successRate}%</p>
                        ${totalFailed === 0 ? 
                            '<p style="color: green; font-weight: bold;">üéâ All tests passed!</p>' : 
                            '<p style="color: red; font-weight: bold;">‚ö†Ô∏è Some tests failed. Check console for details.</p>'
                        }
                    `;
                    
                    setStatus(
                        totalFailed === 0 ? 'All tests passed successfully!' : `${totalFailed} test(s) failed`,
                        totalFailed === 0 ? 'success' : 'error'
                    );
                } else {
                    setStatus('Tests completed but results format unexpected', 'warning');
                }
                
            } catch (error) {
                setStatus(`Error running tests: ${error.message}`, 'error');
                console.error('Test execution error:', error);
            } finally {
                setLoading(button, false);
            }
        });
        
        document.getElementById('runValidation').addEventListener('click', async () => {
            const button = document.getElementById('runValidation');
            setLoading(button, true);
            setStatus('Running translation validation...', 'warning');
            
            try {
                if (typeof TranslationValidator === 'undefined') {
                    throw new Error('TranslationValidator not loaded');
                }
                
                const validator = new TranslationValidator();
                const results = validator.runAllTests();
                
                setStatus(
                    results.failed === 0 ? 'Validation tests passed!' : `${results.failed} validation test(s) failed`,
                    results.failed === 0 ? 'success' : 'error'
                );
                
            } catch (error) {
                setStatus(`Error running validation: ${error.message}`, 'error');
            } finally {
                setLoading(button, false);
            }
        });
        
        document.getElementById('runLanguageSwitching').addEventListener('click', async () => {
            const button = document.getElementById('runLanguageSwitching');
            setLoading(button, true);
            setStatus('Running language switching tests...', 'warning');
            
            try {
                if (typeof LanguageSwitchingTester === 'undefined') {
                    throw new Error('LanguageSwitchingTester not loaded');
                }
                
                const tester = new LanguageSwitchingTester();
                const results = await tester.runAllTests();
                
                setStatus(
                    results.failed === 0 ? 'Language switching tests passed!' : `${results.failed} language switching test(s) failed`,
                    results.failed === 0 ? 'success' : 'error'
                );
                
            } catch (error) {
                setStatus(`Error running language switching tests: ${error.message}`, 'error');
            } finally {
                setLoading(button, false);
            }
        });
        
        document.getElementById('runConsoleErrors').addEventListener('click', async () => {
            const button = document.getElementById('runConsoleErrors');
            setLoading(button, true);
            setStatus('Running console error tests...', 'warning');
            
            try {
                if (typeof ConsoleErrorTester === 'undefined') {
                    throw new Error('ConsoleErrorTester not loaded');
                }
                
                const tester = new ConsoleErrorTester();
                const results = await tester.runAllTests();
                
                setStatus(
                    results.failed === 0 ? 'Console error tests passed!' : `${results.failed} console error test(s) failed`,
                    results.failed === 0 ? 'success' : 'error'
                );
                
            } catch (error) {
                setStatus(`Error running console error tests: ${error.message}`, 'error');
            } finally {
                setLoading(button, false);
            }
        });
        
        document.getElementById('clearConsole').addEventListener('click', () => {
            consoleOutput.innerHTML = '';
            setStatus('Console cleared', 'success');
            setTimeout(() => {
                testStatus.style.display = 'none';
            }, 2000);
        });
        
        // Initial status
        console.log('üîß Translation Test Runner initialized');
        console.log('üìñ Click "Run All Tests" to begin comprehensive testing');
    </script>
</body>
</html>